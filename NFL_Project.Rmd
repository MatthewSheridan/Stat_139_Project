---
title: "R Notebook"
output: pdf_document
---


```{r}
install.packages("tidyverse", type = "binary")
install.packages("ggrepel", type = "binary")
install.packages("ggimage", type = "binary")
install.packages("nflfastR", type = "binary")
```

```{r}
library(tidyverse)
library(ggrepel)
library(ggimage)
library(nflfastR)
options(scipen = 9999)
```

```{r}
cleaned = data.frame()
data <- load_pbp(2020)

sum(data[data$posteam == "NE" & data$pass==1,]$yards_gained)
data[(data$posteam == "NE"),]$home_score

        
        
for (i in unique(data$game_id)){
  home = data[data$game_id == i,]$home_team
  away = data[data$game_id == i,]$away_team
  #home_data = c(sum(data[data$posteam == home & data$pass==1,]$yards_gained, na.rm=T))
  print((sum(data[data$game_id == i & data$posteam == home & data$pass==1,]$yards_gained, na.rm=T)))
}
#252

data[data$game_id=="2020091311" & data$posteam==data$home_team & data$pass==1, ]
```


```{r}
data1 <- load_pbp(2019)
head(data1$game_id,100)

unique(data1$game_id)



df <- c()
for(i in unique(data1$game_id)) {
  temp <- subset(data1, game_id == i) %>% select(PREDICTORS)
  for(j in c(temp$home_team[1], temp$away_team[1])) {
    to_add <- c(j, #team name
                sum(is.na(temp$tackled_for_loss[temp$defteam == j] == 1))
                )
    df <- rbind(df, to_add)
  }
}


```